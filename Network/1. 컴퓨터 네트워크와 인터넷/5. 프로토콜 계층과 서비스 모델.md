# 5. 프로토콜 계층과 서비스 모델
복잡한 인터넷 네트워크 구조에 대한 논의 방식 : 계층화

## 5.1 계층구조
티켓 기능, 수하물 기능, 탑승 기능, 이/착륙, 비행 등의 복잡한 시스템을 갖는 공항 시스템과 마찬가지로 컴퓨터 네트워킹 또한 전체 과정을 단계별로 계층화 할 수 있다.  

#### 계층화의 장점:
- 특정 부분에 대해 독립적으로 논의할 수 있다.
- 한 계층의 서비스 구현을 변경하는 것이 용이하다. (다른 계층에 영향을 주지 않는다.)

### 프로토콜 계층화
네트워크에서 각 프로토콜은 특정 한 계층에 속한다.  
한 계층이 상위 계층에 서비스를 제공한다는 관점에서 이것을 **서비스 모델(service model)**이라고 한다.  
예를 들어, 한 계층에 특정 기능을 구현하고자 한다면 하위 계층의 서비스를 사용하면서 구현하고자 하는 기능을 추가하면 된다.  
또한, 각 프로토콜 계층은 소프트웨어, 하드웨어 혹은 통합으로 이루어질 수 있다.

#### 계층화의 잠재적 결점: 
- 한 계층의 기능이 하위 계층과 기능적으로 중복된다.
- 어느 한 계층에서의 기능이 다른 계층에만 존재하는 정보에 의존할 수 있다. (계층 분리 목적에 위배됨)

### 애플리케이션 계층
- 대표 프로토콜: HTTP, SMTP, FTP 등
- 주요 기능
  - 사람이 읽을 수 있는 주소 이름 변환 기능(DNS)
  - 다른 종단 시스템의 애플리케이션과 정보 패킷 교환
- 데이터 단위: 메시지(message)

### 트랜스포트 계층
- 대표 프로토콜: TCP, UDP
- 주요 기능
  - 클라이언트와 서버 간 애플리케이션 계층 메시지 전달
  - TCP: 연결 지향형 서비스, 메시지 전달 보장 및 흐름 제어, 혼잡 제어
  - UDP: 비연결형 서비스
- 데이터 단위: 세그먼트(segment)

### 네트워크 계층
- 대표 프로토콜: IP, 다양한 라우팅 프로토콜
- 주요 기능
  - 한 호스트에서 다른 호스트로의 데이터그램 라우팅 (목적지 주소 기준)
  - 출발지의 트랜스포트 계층에서 내려보낸 세그먼트를 목적지의 트랜스포트 계층으로 운반
- 데이터 단위: 데이터그램(datagram) 또는 패킷(packet)

### 링크 계층
- 대표 프로토콜: 이더넷, 와이파이, DOCSIS 등
- 주요 기능
  - 네트워크 계층에서 받은 데이터그램을 다음 노드로 운반
  - 다음 노드 도착 시 상위 네트워크 계층으로 데이터그램 전달
  - 각각의 링크마다 다른 프로토콜에 의해 처리될 수 있음
- 데이터 단위: 프레임(frame)

### 물리 계층
- 종류: 꼬임쌍선, 동축케이블, 광케이블 등
- 주요 기능
  - 프레임 내부의 각 비트를 한 노드에서 다음 노드로 운반
  - 링크의 실제 전송 매체에 의존

## 5.2 캡슐화
- 각 계층의 데이터를 캡슐화해서 하위 계층으로 전달하면, 해당 하위 계층은 전달받은 데이터(페이로드)에 본 계층의 기능을 위한 추가 데이터(헤더)를 추가하여 다시 캡슐화 한 후 다음 하위 계층으로 전달
- 따라서, 각 계층의 데이터는 **헤더 필드**와 **페이로드 필드(payload field)** 로 구성
- 수신 측은 각자 자신의 계층에 해당하는 데이터를 확인하기 위해 받은 캡슐을 분할